<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>BuonBanVat SDK Test</title>
    <script src="https://sdk.minepi.com/pi-sdk.js"></script>
  </head>
  <body>
    <h1>ðŸ›’ BuonBanVat SDK Test</h1>
    <p>ChÃ o má»«ng Ä‘áº¿n vá»›i báº£n thá»­ nghiá»‡m chá»©c nÄƒng thanh toÃ¡n Pi.</p>

    <button id="login-button">ðŸ”‘ Login Pi</button>
    <button id="pay-button">ðŸ’¸ Thanh ToÃ¡n Test</button>

    <script>
      // ðŸ§  1. Initialize SDK â€” thÃªm scope "payments"
      Pi.init({
        version: "2.0",
        sandbox: true,
        appId: "buonbanvatmarket",
        scopes: ["username", "payments"], // Pháº£i cÃ³ "payments"
      });

      // ðŸ§ª 2. Login Handler
      document.getElementById("login-button").addEventListener("click", () => {
        Pi.authenticate(
          ["username", "payments"],
          function (auth) {
            alert("ÄÄƒng nháº­p thÃ nh cÃ´ng:\n" + JSON.stringify(auth));
          },
          function (error) {
            alert("Login failed: " + error);
          }
        );
      });

      // ðŸ’³ 3. Payment Handler
      document.getElementById("pay-button").addEventListener("click", () => {
        Pi.createPayment(
          {
            amount: 0.001,
            memo: "Thanh toÃ¡n test Pi SDK",
            metadata: { item: "Test SDK" },
          },
          {
            onReadyForServerApproval: function (paymentId) {
              alert("Ready for server approval: " + paymentId);
            },
            onReadyForServerCompletion: function (paymentId, txid) {
              alert("Ready for server completion: " + paymentId + "\nTXID: " + txid);
            },
            onCancel: function (paymentId) {
              alert("Thanh toÃ¡n bá»‹ huá»·: " + paymentId);
            },
            onError: function (error, payment) {
              alert("Thanh toÃ¡n lá»—i: " + error);
            },
          }
        );
      });
    </script>
  </body>
</html>
