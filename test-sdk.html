<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>BuonBanVat SDK Test</title>
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
  <script>
    // Khởi tạo SDK (rất quan trọng, phải trước mọi lệnh)
    window.Pi.init({ version: "2.0", sandbox: false });

    async function login() {
      try {
        const scopes = ['username', 'payments'];
        const user = await window.Pi.authenticate(scopes);
        alert("✅ Đăng nhập thành công: " + user.username);
      } catch (err) {
        alert("❌ Lỗi đăng nhập: " + err.message);
      }
    }

    async function pay() {
      try {
        const paymentData = {
          amount: 0.01,
          memo: "Test thanh toán Pi",
          metadata: { purpose: "SDK test", app: "BuonBanVat" }
        };
        const payment = await window.Pi.createPayment(paymentData);
        alert("💰 Giao dịch gửi đi: " + JSON.stringify(payment));
      } catch (err) {
        alert("❌ Không thể tạo giao dịch: " + err.message);
      }
    }
  </script>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 40px;
    }
    h1 {
      font-size: 24px;
    }
    button {
      font-size: 18px;
      padding: 10px 20px;
      margin: 10px;
    }
  </style>
</head>
<body>
  <h1>🛒 BuonBanVat SDK Test</h1>
  <p>Chào mừng đến với bản thử nghiệm chức năng thanh toán Pi.</p>
  <button onclick="login()">🔐 Đăng nhập Pi</button>
  <button onclick="pay()">💰 Thanh toán 0.01 Pi</button>
</body>
</html>
