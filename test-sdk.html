<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>BuonBanVat SDK Test</title>
    <script src="https://sdk.minepi.com/pi-sdk.js"></script>
  </head>
  <body>
    <h1>ğŸ›’ BuonBanVat SDK Test</h1>
    <p>ChÃ o má»«ng Ä‘áº¿n vá»›i báº£n thá»­ nghiá»‡m chá»©c nÄƒng thanh toÃ¡n Pi.</p>

    <button id="login-button">ğŸ”‘ Login Pi</button>
    <button id="pay-button">ğŸ’¸ Thanh ToÃ¡n Test</button>

    <script>
      window.addEventListener("load", () => {
        if (window.Pi) {
          Pi.init({
            version: "2.0",
            sandbox: true,
            appId: "buonbanvatmarket",
            scopes: ["username", "payments"],
          });

          console.log("âœ… Pi SDK initialized!");
        } else {
          alert("âŒ Pi SDK chÆ°a sáºµn sÃ ng. Vui lÃ²ng táº£i láº¡i báº±ng Pi Browser.");
        }

        // NÃºt Login
        document.getElementById("login-button").addEventListener("click", () => {
          Pi.authenticate(
            ["username", "payments"],
            (auth) => alert("âœ… ÄÄƒng nháº­p thÃ nh cÃ´ng:\n" + JSON.stringify(auth)),
            (error) => alert("âŒ Login tháº¥t báº¡i: " + error)
          );
        });

        // NÃºt Thanh toÃ¡n
        document.getElementById("pay-button").addEventListener("click", () => {
          Pi.createPayment(
            {
              amount: 0.001,
              memo: "Test SDK thanh toÃ¡n",
              metadata: { item: "TestItem" },
            },
            {
              onReadyForServerApproval: (paymentId) =>
                alert("ğŸŸ¡ Ready for Approval: " + paymentId),
              onReadyForServerCompletion: (paymentId, txid) =>
                alert("ğŸŸ¢ ThÃ nh cÃ´ng: " + paymentId + "\nTXID: " + txid),
              onCancel: (paymentId) => alert("âšª Bá»‹ huá»·: " + paymentId),
              onError: (err, payment) =>
                alert("âŒ Thanh toÃ¡n lá»—i: " + err + "\nChi tiáº¿t: " + JSON.stringify(payment)),
            }
          );
        });
      });
    </script>
  </body>
</html>
